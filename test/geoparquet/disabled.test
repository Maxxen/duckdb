# name: test/geoparquet/disabled.test
# group: [geoparquet]

require parquet

#------------------------------------------------------------------------------
# Test reading geoparquet when conversion is disabled
#------------------------------------------------------------------------------
query II rowsort
SELECT col, geometry FROM '__WORKING_DIRECTORY__/data/geoparquet/data-point-encoding_wkb.parquet'
----
0	POINT (30 10)
1	POINT EMPTY
2	NULL
3	POINT (40 40)

statement ok
SET enable_geoparquet_conversion = false;

query II rowsort
SELECT col, geometry FROM '__WORKING_DIRECTORY__/data/geoparquet/data-point-encoding_wkb.parquet'
----
0	\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00>@\x00\x00\x00\x00\x00\x00$@
1	\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\xF8\x7F\x00\x00\x00\x00\x00\x00\xF8\x7F
2	NULL
3	\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00D@\x00\x00\x00\x00\x00\x00D@