# name: test/sql/peg_parser/transformer/attach_statement.test
# description: Test analyze and vacuum statements in peg parser
# group: [transformer]

require autocomplete

require skip_reload

require no_extension_autoloading "FIXME: to be reviewed whether this can be lifted"

statement ok
PRAGMA enable_verification

statement ok
set allow_parser_override_extension=strict;

statement ok
ATTACH '__TEST_DIR__/persistent_attach.db'

statement error
ATTACH '__TEST_DIR__/persistent_attach.db'
----

statement error
ATTACH '__TEST_DIR__/error.db' (TYPE DUCKDB, HELLO, OPTION 2);
----
<REGEX>:Binder Error.*Unrecognized option for attach.*

statement error
ATTACH '__TEST_DIR__/error.db' (HELLO, OPTION 2);
----
<REGEX>:Binder Error.*Unrecognized option for attach.*

# create a database file and close it again
statement ok
ATTACH '__TEST_DIR__/attach_read_only.db' AS db1

statement ok
DETACH db1

statement ok
ATTACH '__TEST_DIR__/attach_read_only.db' AS db1 (READONLY 1)
