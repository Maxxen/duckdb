# name: test/sql/copy/parquet/parquet_large_list.test_slow
# description: Test Parquet Reader / Writer on very large set of lists
# group: [parquet]

require parquet

statement ok
CREATE TABLE test_10m_arrays AS
SELECT list_resize([]::TINYINT[], 10000000, 1::TINYINT) AS large_array
FROM range(300);

statement ok
COPY (SELECT * FROM test_10m_arrays) TO '__TEST_DIR__/test_10m_arrays.parquet';

statement ok
DROP TABLE test_10m_arrays;

query I
SELECT large_array.len().avg() AS avg_length FROM '__TEST_DIR__/test_10m_arrays.parquet';
----
10000000.000000
